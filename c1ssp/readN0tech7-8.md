ch7 PKI密碼應用
```
你要加密消息要用接收者公鑰
要解密對方發給你消息用自己的私鑰
要發給別人的數位簽章用自己的私鑰
要驗證別人的數位簽章用發送方的公鑰

非對稱密碼 任意把自己的公鑰傳輸給對方加密，用自己私要解密．通常用簡短消息 利用素數數學原理支撐
｜對稱｜128 |
｜RSA｜3027|
｜橢圓｜256 |
RSA  ElGraml ECC橢圓曲線密碼 
Diffie Hellman 允許通過不安全通道生成共用密鑰與對稱加密算法通信(hybrid混合密碼)
-不是加密協議，只是密鑰交換協議、常用於TLS使用(DHE or EDH)創建共享密鑰
-ECDHE密鑰交換算法是種變體用到橢圓曲線問題來執行類似密鑰商定過程

量子密碼 量子比特qubit的多為量子為取帶數字計算二進位，讓RSA、DH流行算法便不再安全
-量子密鑰分發 quantum key distribution QKD執行方案 類似DH窗間共享密鑰

哈希函數 hash function
-較長>=128 訊息產生唯一輸出值持行偶基校驗功能
-五要求：輸入任何長度、輸出固定長度、哈希函數對輸入相對容易、單向函數、抗碰創
-HAVAL是md5修訂版使用1024為塊產生 128, 160,192,224,256

SHA NIST, FIPs180
-SHA1  任何長度生成一個160位消息摘要，可處理512塊中的消息，用附加數來填充消息 2017棄用
-SHA2。四個變體
SHA-256｜512位塊大小 生成256位消息摘要
SHA-224｜512位塊大小 生成224位消息摘要
SHA-512｜1024位塊大小 生成512位消息摘要
SHA-384｜1024位塊大小 生成384位消息摘要
SHA3跟SHA2同等安全強度但是比較慢

MD5
-MD2可為8位處理器產生哈希、MD4支持32位處理器產生哈希 摘要都是128位元
-MD5與MD4相同但是消息長度512位的倍數小64位，降低生成速度，很容易出現碰撞

RIPEMD (128=256,160=320) 是SHA系列的替代方案，被應用在加密貨幣 160現在是安全的

數位簽章  公鑰加密碼跟哈希組合，只對簽章本身做保密性 身份不可否認性
-保證是發送者(不可否認性)，抵制惡意竄改．
-明文生成哈希摘要、再把私鑰單獨哈希摘要加密(就是數位簽章)
-簽名消息摘要附件明文消息末尾，明文用對方的公鑰加密
-對方收到自己的公鑰解開數位簽章，在用對方私鑰解開秘聞

HMAC 可保證傳輸過程的完整性，但不提供不可否認的服務
-通過共用密鑰跟任何hash算法配套使用，只有知道密鑰通信參與方才可以生成或驗證．

數位簽章標準 DSS FIPS 186-4 (必須是SHA3的hash)
支持基礎設施或批准的三種標準加密算法
1.FIPS 186-4|DSA by ElGamal ==> EdDSA 曲線數字簽名算法
2.ANSI X9.31|RSA
3.ANSI X9.62|DSA(ECDSA)橢圓曲線

PKI public key infrastructure 公鑰基礎設施
-協助不認識雙方進行通信，把對稱、非對稱、數位簽章、哈希結合使用混合加密法

證書 certificate  一個人的公鑰簽注副本由可信發證機構CA發簽，讓公鑰是合法．
-遵守X.509版本、證書創建者編制的序號、簽名算法標示符、發證者名稱、效期起始終止日
-主體名稱(普通名稱CN,公鑰實體可識別名稱DN)、主體的公鑰(證書主要內容、擁有者建立安全通信實際公鑰)
-證書使用目的包含對象的公鑰：計算機機器、個人用戶、電子郵件地址、開發者(代碼簽名的證書)
發證機構 CA certificate authority
-自己身份已達到這幾家CA的要求
-如果你自己websiteg設置信任一家CA，自動信任這家發的數字簽證

註冊機構 RA registration authority 本身不直發簽證書，負責認證過程讓CA能遠程驗證用戶身份
離線CA保護自己的根證書root certificate不被需要時斷網斷電，離線CA創建次級中間CA充當在線CA．
-證書鏈，為了驗證證書．瀏覽器鮮豔正中間CA身份，沿著信任路徑追朔到已知根CA
-自簽證書，內部系統配置後可信任CA單不對外遊覽器信任，節約獲取證書費用

證書生命週期 註冊>驗證>註銷
1.註冊enrollment 向CA證明自己的身份
-CSR certificate signing request證書簽名申請提供自己的公鑰，CA創建一份X.509格式證書(身份識別和公鑰拷貝)
-CA在證書上用CA私鑰寫上數位簽名並把簽了名的數位簽章副本給你
-域驗證 domain Validation  CA只驗證證書主體對域名是否有控制權．
-擴展驗證 extended Validation CA採取步驟驗證擁有人是不是合法企業
2.驗證 用CA公鑰檢查CA在證書上數位簽章跟效期．CACA
-必須比對證書註銷列表CRL certificate revocation list和在線證書狀態協議OCSP online certificate status protocol來確定這份證書未被註銷
-需滿足要求 CA數位簽章真實、你信任這家CA、未被CRL收入、證書包含你信任的數據
3.註銷 revoke
-失信擁有者意外洩露私鑰、CA誤發證書、細節更改(主體名稱變化)、安全關聯變更(主體不再被CA雇用)
三種驗證正數真實性和識別被註銷的證書
-證書註銷列表CRL 各家發證機構維護(發簽註銷序號、註銷生效日期時間)，定期下載交叉比對
-在線證書狀態協議OCSP 客戶端收到CA'sOCSP發送一個OCSP請求，伺服器把該證書有效無效未知狀態回復給客戶端
-證書裝訂(效期24hrs) OCSP的擴展 接受簽名和時戳裝訂或附加在數位簽章上，web將證書跟OCSP裝訂一起發送給用戶

證書格式
DER|區分編碼規則|二 進 制|.der, .crt, .cer
PEM|隱私增強郵件|ASCII文本|.pem, .crt
PFX|個人信息交換|二 進 制|.pfx, .p12
P7B|          |ASCII文本|.p7b
-
-
-
-
-
-
```
