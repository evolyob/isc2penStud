ch8安全模型設計和能力原則
```
主體subject 觸發資源訪問請求的主動實體
客體object  主體想要訪問的被動實體

封閉系統 小範圍 來自同一個製造商
-需進行定義定義是改變才能成功，需獨特手段(脆弱組件)需要深入了解才能發起攻擊成功
開放系統  公認行業標準、支持相同標準API系統集成
-API 提出請求類型、確切方式、交換數據形式、身份驗證、會話加密
-存在可預見入口點攻擊手段
＊＊
開源系統  源代碼跟內部邏輯公開的解決方案，公開審查評議改進產品
閉源系統  源代碼跟內部邏輯對公眾保密(商用)，自己的RD不斷修改

默認安全設定  最大限度降低首次安裝或支持成本，依照組織安全策略對導入或使用配置選項做調整降低安全風險
失效安全 
-程序錯誤處理(異常處理)、預防錯誤機制通過編碼來避免中斷的糾正錯誤if else
-沒做軟體失效設計、他發生的故障是整理故障，考量要保護或犧牲什麼
|保護人員<<|失效打開>>|保護可用性
|保護人員<<|失效保障>>|保護保密性跟完整性
|保護資產<<|失效關閉>>|保護保密性跟完整性
|保護資產<<|失效安全>>|保護保密性跟完整性

保持簡單 RD避免把環境機構設計過於複雜 不然全面測試難度大、出錯地方越多、受攻擊面更寬
-不自我重覆  減少多處使用相同代碼 消除軟件中冗余降低修改難度
-計算極簡    少用應軟件資源也就是計畫評審技術PERT的目的，易保護、易排錯、易驗證
-最低耗能    顯則是和最低耗能編程語言，真正需要才添加能力和功能

零信任 NIST 800-207
-防止內部突破安全屏障自由橫向移動，任何活動或訪問都要進行驗證 永不信任始終驗證
-內部分段防火牆ISFW、子網、VLAN隔開子域，之間溝通都要驗證身份IAM和會話加密、ACL
-氣隙air gap 完全隔離取代控制和過濾交互，可能有線和無線網路連接都不可以

通過設計保護隱私 PbD privacy by Design  設計就集成到產品
-七大基本原則
>主動而非被動，預防而非修補
>默認方式保護隱私
>隱私嵌入式設計
>所有功能 正和而非零和
>端到端安全 全生命週期保護
>可見性和透明性
>尊重用戶隱私
信任但要驗證  防範內部攻擊和橫向移動環境訪問權限

進程限定 只能對某些內存位子跟資源做讀寫的最小特權，不接受其他非法訪問寫進違規日誌
界限    授權級別、特約在特定區域、每個進程使用內存邏輯區、給內存物理隔離
隔離    隔離可確保被隔離進程只被關聯的內存和資源影響，不論訪問是善意還是惡意的隔離，自己崩潰也不會干擾到其他 
訪問控制 只允許主體訪問得到授權的客體的合法訪問規則(自主DAC、基於角色RAAC、強制MAC)
信任系統  所有保護機制協同工作、環境保持穩定、安全系統、變更管理、補丁管理、配置管理
保證 滿足安全需求可信程度 即時更新反覆驗證

令牌token            與資源關聯獨立客體、描述訪問前資源安全屬性
能力capability list  每個受控客體寶文一列安全屬性信息，提供較快截查找
標編security label   一但設定無法更改
```
安全模型種類

|完整性|biba|clark-wilson|HRU|
|:--:|:--:|:--:|:--:|
|保密性|無干擾模型||||
|兩者兼|bell-laPadula|sutherland||

|狀態流|bell-laPadula|brewer and nash|biba|clark-wilson|
|:--:|:--:|:--:|:--:|:--:|
|信息流|無干擾模型|sutherland|||

|可信計算基|狀態機模型|信息流模型|無干擾模型|獲取授予|訪問控制矩陣|
|:--:|:--:|:--:|:--:|:--:|:--:|
bell-lapadula|biba|clark-wilson|brewer and nash|
goguen-mesesguer|sutherland|graham-denning|harrison-ruzzo-ullman|

```
＊＊＊
>Trusted computing base TCB 可信計算基
-安全邊界  假想邊界與其餘部分分隔出來，與其他必須建立安全的可信路徑、可信殼可防止其他進程”蠢“入可信殼影響主體
-參考監視器  請求前驗證符合訪問客體要求的監控，不論是自主、強制、基於角色或其他形式
-安全內核   啟動相關組件執行參考監視並抵禦已知攻擊，協調對資源所有訪問請求

>狀態機模型 state machine model 不碖什麼狀態始終安全的系統 基於FSM有限狀態機
-為各種複雜 解析器、解碼器、解釋器都給訂一個輸入一個狀態轉換另一個狀態可能產生的輸出
-state 特定時刻系統快照、接受輸入或產生輸出都會轉換新狀態都必須接受評估、並只允許符合安全策略方式訪問資源．

>信息流模型| 基於狀態機模型 處理流動方向跟流動類型和不同安全級別、可阻止未授權不安全來限制信息流
-表明一個對象從一個時間點的狀態在另一個時間點另個狀態轉換，明確排除所有非定義流路徑來解決隱蔽信道問題

>無干擾模型(goguen-meseguer)| 基於信息流模型 較高級安全級別主體動作會對系統狀態或較低級別主體動作產生影響
-提供一種防木馬、後門、root kit惡意程序的手段、 級聯、反饋、連接

>獲取授予take grant| 擁有授權主體可把自己的有的任何權限授予另個主體或客體的規則建立或移除(缺:無意間分配權限)
-四條規則：主獲取(複製)客體權限、主向客體授予(複製)權限、主體創建先權限、移除自身擁有權線
-需要具創建獲分配權限對象帳戶創建，對象是有完全控制和管理權的主體．
>訪問控制矩陣access control martix|標明每個主體可以執行的操作和功能的ACL訪問控制列表
-主體可對客體具有權限列表存到各主體，給每個用戶個別的key具有訪問權或其他權限
-形成一個強制性或基於角色的矩陣，快速確認主體請求對客體是否授權

？基於格子訪問控制lattice-based access control|快速預覽 會在格子中分配一個位子，主體只能訪問位於最小上界跟最大下界之間客體
＊＊
>bell-laPadula(need to know)|可按因需可知的訪問許可級別跟級別以下，攔截低對高權限訪問、適於保護數據保密性
-狀態三種基本屬性 不可向上讀、不可向下寫(＊屬性)、通過訪問矩陣自主訪問控制歸則｜轉換安全跟涉及隱蔽信到問題
-例外規定：允許可信主體違反執行向下寫操作，當需要給有效客體移除安全分類或重新定義

**** 簡單屬性：讀、星屬性：寫 **** 未被明確規定是隱含被允許
最佳解釋"否定陳述">>"隱含操作"
＊＊
>biba| 側重在完整性、基於信息流 反向的bell-laPadula 不可向下讀、不可向上寫(＊屬性)
-解決三個完整性問題：放指未經授權修改主體或客體、保護內外部客體的一致性
-缺點：只有完整性、未考量內部威脅會以程序化處理、沒設別訪問控制管理、沒提供分配跟更改定義密級別方式、不能阻擋隱蔽信道
>clark-wilson|數據完整性
-定義每個數據只允許一個受限或受控中間程序或接口進行修改、三元祖(主體、程序(交易)、客體)
-組織的完整事務和'職責分離原則'保護完整性，只能透過程序、接口、訪問門戶，對每個程序能對客體的數據資源可以做和不可有具體限制
-受約束數據 CDI constrained    |受安全模型保護任何數據
-無約束數據 UDI unconstrained  |不受安全模型控制，任何輸入未經驗證數據或輸出都是無約束數據
-完整性驗證 IVP integrity verification |掃描數據並確認完成性
-轉換規程 TP  transformation  | 允許修改CDI的唯一規程，通過TP限制對CDI訪問
---為不同級別或類別用戶提供不同功能，可向所有用戶顯示所有功能但被禁用未授權，也是和保護保密性
>brewer and nash|狀態機模型
-每個衝突類別內使用數據隔離原則、動態更新衝突類的成員和定義、降低利益衝突
-阻止有權訪問屬於特定衝突類別的安全域的任何主體訪問屬於相同衝突類別的其他任何安全域
-管理員對任何衝突數據訪問都會被攔截，只能訪問與初始數據相關，完成任務後才恢復為完全控制
> goguen-meseguer 非干涉性模型、完整性
-預先確定客體及或域列表，只允許對預定客體執行預定操作，劃分到各自的域不能干擾其他主體域成員、主體不能彼此干擾

>sutherland 透過防止干擾 完整性
-只使用被預先定義的安全狀態保持完整性和阻止干擾、防止隱蔽信道
>graham-denning 安全創建與刪除 八條保護規則定義安全操作邊界
-安全創建刪除客體、安全創建刪除主體、安全提供讀取授權刪除傳輸訪問權
>harrison ruzzo ullman HRU
-有限規程及為中心、利用這些規程編輯或更改主體對客體的訪問權限，每行每列的交集包含主體對個客體持行具體的規程
-有限命令(必須都成功)或基元集(新增、刪除訪問權限)，完整性原則：創建或添加必須是原本不存在、刪除必須是已存在

***星模型  利用分支任務完成實現業務目標***
```
通用準則 CC common Creteria 安全能力級別，級別標注數字代表哪種測試和確認
|D|EAL1|最小化|功能測試|保護個人信息、盡關心的執行獨立保證|
|:--:|:--|:--|:--|:--|
|C1|EAL2|自主安控|結構測試|交付設計和測試結果、低至中等級有獨立保證安全性，舊系統|
|C2|EAL3|受控訪問|系統測試和檢查|還在設計階段為實質改變，中等級有獨立保證安全性|
|B1|EAL4|標籤化|設計測試審查|適用嚴格、主動安全工程良好商業開發規範、所有安全功能獨立測試|
|B2|EAL5|結構化|半正式設計測試|嚴格安全工程和商業開發規範，半測試求得高級別並有獨立保證安全性|
|B3|EAL6|安全域|半正式驗證設計測試|須面對高風險為期增加成本，大範圍測試可降低遭滲透風險、存在隱蔽信道可能及攻擊脆弱性|
|A|EAL7|已驗證|正式設計測試|最高風險或高價值，要求安全功能必須接受大範圍正式分析、測試的受評估對象|

-提升已評估已評級產品安全性信心、消除重復評估、提高安全評估效率和效果、一致的高標準、產品可用信、受評估產品功能和保證
```
-ISO定義工商業設備軟體協議管理標準：國際標準、技術報告、技術規範、公開可用規範、技術勘誤表、指南
＊＊
操作授權 ATO authorization to operate RMF定義一個概念 NIST SP 800-37 Rev.2
-操作授權通常期限五年，若出現時間期限到期、嚴重安全事件、重大安全變化就必須重新申請．
-決定哪些安全事件或變化導致操作授權失敗、入侵、重要補丁操作導致失敗要做
-四種決策："操作授權"風險達到可接受、繼承另家供應商"通用控制權"限風險可接受水平並得到授權操作、供應商達到可接受水平"使用授權"、風險不可接受就"拒絕授權"

內存保護 避免不穩定、破壞完整性、拒絕服務、數據洩漏、內存區域交互
虛擬化   一台主機運行多個操作系統或不兼容應用程序，主旨在隔離操作系統
受約素或限制接口 借助功能隱藏需要特殊操作才可看見(clark-wilson)
容錯 雖然發生故障但可繼續運行能力，避免單點故障和執行冗余部分措施
加解密 明文轉換密文 對稱非對稱保護保密性和完整性解決方案

```
