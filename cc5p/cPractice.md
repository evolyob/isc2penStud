
云安全原理与实践
```
社區雲 每個參與特定客戶共享，對個別客戶分別控制一個雲基礎設施安全邊界、能接入端建立個安全邊界
釋放的資源分配給其他虛擬機，需鏡像分析前一台虛擬機遺留下的重要信息

關鍵雲端特性帶來漏洞
未經授權的管理介面訪問、網路協議漏洞(中間人)、數據恢復漏洞(取得遺留資料)、逃避計量和計費
多用戶共用一台服務器，利用虛擬機逃逸而控制主系統

雲端數據生命週期
1. 數據生成   數據所有者創建為儲存到雲端，安全級別劃分保護方案、預處理(效能、費用考量)、數據稽核
2. 數據儲存   存放地理位址不確定性、混和儲存(隔離政策)、丟失竄改的惡意攻擊
3. 數據使用   訪問控制(未授權)、傳輸風險(攔截、故障)、雲端性能(傳輸處理想硬要求期望)
4. 數據共享   信息丟失(數據轉換格式丟失)、應用安全
5. 數據歸檔   冷資料單獨設備保存，或因合規保存特殊數據時間期限
6. 數據銷毀   刪除後可被恢復(刪除殘餘數據)、雲服務商不可信(是否真刪除數據，存在其他備份?)

加密與密鑰風險 : 儲存地理不確定、單一主機的多客戶操作系統之間洩漏、海量敏感數量在單一雲端高度集中
---->> 儲存位置、關鍵程度、當前狀況(靜止,傳送)定加密等級

1.API簽名安全  :  請求參數是否竄改、來源是否合法、使否具有唯一性
2.API防重放攻擊:  時效內唯一標示(AppKey+API+Nonce)、AppKey是APIgw控制台生成、刪除時注意其他開通服務
3.API流量控制  :  流量控制策略可以配對API、用戶、應用三個對象流控值(不可超過次數/天)
4.API授權管理  :  客戶才能用APP調用、建立落解除之間授權關係，API gw對其app權限關西進行驗證。

安全策略風險
服務中斷  :
-->技術軟硬件通信鏈路故障、未盡有效安全保護監控維護或沒制定應急響應方案
-->環境風險    天然災害、不可抗因素造成設施受損、水電供給、通信鏈路中斷
-->操作錯誤    租戶管理員操作不但配置錯誤導致
-->惡意攻擊    造成中斷勒索破壞
供應鏈第三方風險
-->產品風險  笧品不合規國內標準或安全需求、假冒偽劣設備
-->服務風險  基礎設施服務提供正常服務、外包服務是否有安全能力避免不穩定威脅
-->內部人員風險 內部開發遵循安全規範、洩漏風險及存在相關漏洞和雲維運人員的方式目的是否合規

數據跨境流動
1. 禁止重要的數據跨境流動 :  只本地儲存重要(威脅國家安全數據)、利用簽訂相關協議明確禁止
2. 有條件限制數據跨境流動 :  一般、行業相關的技術數據、非保密信息經過風險評估才可實作。
3. 允許普通人個人數據跨境流動: 採用問責制和合同干預(政府制定)模式進行管理

個人隱私保護不當
1. 儲存過程中對個人隱私造成侵犯 : 用戶無法得知確定儲存位置，無法對採集,儲存,使用過程進行有效控制
2. 傳輸過程對個人隱私造成侵犯  : 傳輸具有開放性和多元性的特稱，更加無法保證數據傳輸過程的安全性
3. 處理過程對個人隱私造成侵犯  :  因部屬引入大量的虛擬技術，所以需要
4. 銷毀過程對個人隱私造成侵犯  :  單純刪除無法得知服務商是否備份可能，增加不徹底刪除可能性。

安全設計原則  
-->最小特權      限制每個主體可進行操作並定期審計，減少前在互相影響消除不必要不適當使用
-->職責分離      多人劃分任務級個別所需權限，消除對關鍵系統的權利與影響(不含後門、強制休假、輪替)
-->縱深防御      物理設施(CCTV)、網安(DDoS)、雲平台、主機安全(IDPS)、應用安全(VA,PT)、數據安全(BK,encrypt)
-->防禦單位解耦  防禦和服務不互相影響獨立工作(VPC)
-->面向失效的安全設計  某種防禦失效通過補救進行有效防御
-->回朔和審計   完善日誌系統和審計系統對資源分配、教穡授權、操作行為審計，對安全事故審查跟恢復能力
-->安全數據標準化  CTP雲可信協議、CADF雲審計數據互聯
```

||數據安全|應用安全|主機安全、雲平台|網絡安全|物理安全|
|:--|:--|:--|:--|:--|:--|
|安全防護|快照、備份、DR|維運MFA|用戶身分週期、組態加固、FW|區域劃分、VPN||
|    |安全儲存、清除|WAF|MFA、多租戶隔離、EDR|邊界訪問控制、IPS||
|監控檢測|    |web VA、掛馬|portScan、PT、入侵檢測|SIEM、DDoS檢測分析||
|審計跟蹤|數據庫稽核||NTP、Logs、opsAudit|DDoS抓包取證||
|響應恢復|備份恢復|web補丁|SOAR|SOC、DDoS防護||


```
1.服務器虛擬化特性
-->多實例  一台物理機多個操作系統，資源整合可控分配
-->隔離性  選擇不同OS互相獨立不干擾並透過網路進行虛擬機互相訪問
-->封裝性  虛擬化進行硬建資源分配及兼容性
-->高性能  虛擬機監控監視器開銷應控制在可承受範圍

--> 降低營運成本、提高應用兼容、加速應用部屬、提高服務可用、提升資源利用、動態調度資源、降低能源耗損

2.主要安全威脅
-->虛擬機間安全威脅  因數據不經外部硬體安全機制，無法對橫向流量有效監控或實施高級安全策略
-->虛擬機與宿主機之間安全威脅  宿主機被控制取得特權，可對同主機的虛擬機進行公擊跟宿主機本地網路和相鄰系統
-->虛擬機控制中心的安全威脅    中控台傭有所有最高訪問控制權限，否則面臨極大威脅
-->虛擬機蔓延及管理疏漏的隱患   完成工作後，無人管理閒置造成資源浪費且無更新及口令

3.虛擬機逃逸   繞過隔離限制值接運行宿主機上造成安全模型完全崩潰
4.rootkit攻擊  三要素:隱藏蹤跡、保留root操縱開後門、收集數據，與木馬後門等惡意程式結合使用。
---> 因無法確定造成損害，最好方法就是擦除並重灌

5.安全解決方案
---> 虛擬化安全防御架構  不同層級給出相應安全防護措施(可信計算硬件技術、虛擬機監視行為)
---> 宿主機安全機制   若是物理訪問就可各種攻擊，關機嗅探
---> Hypervisor自身安全加固  盡簡化功能、減少代碼存在漏洞、良好合離性、I/O操作安全性、保護Hypervisor完整性
**Hypervisor 的輕量型軟體層，在虛擬機器和底層的實體硬體之間進行協調。又稱虛擬機器監視器**
---> 提高Hypervisor防護能力  建構虛擬防火牆(流量間控、過濾和保護)、主機資源合理分配優先級、
---> 細粒度權限訪問控制(用戶具有管理權限、可能執行危險操作)

6.虛擬機隔離機制 
---> Hypervisor安全隔離機制，每個進程都有獨立地址戶不干擾，若被突破扔無法訪問不屬於他的資源
---> sVirt標籤技術  利用Selinux系統強制訪問控制策略MAC標籤  
---> 切VLAN、設立防火牆保證虛擬機地隔離
```
```
網路虛擬化安全
---> SDN架構 應用層(北RESTful,SOAP)、控制層、基礎設施層(南OpenFlow)
---> SDN三特  控制與轉發分離、集中化的網路控制、開放編成接口

IaaS網路安全御的劃分與夠建 OpenStack
---> 公有(對外開放)、用戶(由租戶完全控制)、管理信息(平台跟內部交互區域(級高保密和完整性需求))、數據(鏡向、儲存(保密和完整性需求可能需要可用性))
---> 
---> 
---> 
---> 
---> 
---> 
---> 

檢查JS    npm audit, eslint
```
