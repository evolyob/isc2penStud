
ch. 7 雲運用安全

```
培訓和意識宣貫
--數據所涉及相關責任、確定數據敏感性特徵否則在使用過程中、使數據暴露於不必要的風險
--業務角度看數據性質和敏感度時常變化或實際價值是有限、會更適於轉移到雲端並以最低力度和風險進行保護
--本身沒有足夠資源自行管理應用安全、雲安全性更好？雲供應商有訓練有素技能熟練全天候執行各項監測
--法規強制監管確保數據安全、應用世安設計運行和工作、即使編碼的問題只是無法完成某項功能不導致問題的交易
--垂直升降forklifting 轉移到雲端只要代碼少量改變或不改的獨立應用
各種原因的問題
--應用依賴傳統特定基礎架構難以複製到雲端、雲環境沒有所需的私有庫
--不對某類代碼大量變更㺵無法宜轉到雲端、基於雲的版本可最大限度減少或消除將這些應運從本地轉移到雲環境的必要性
--開源庫在雲端通常更容易受到竄改而面臨更大的風險、不熟悉新環境、特定平台不用雲應用開發
--架構和安全方面技術不成熟、相關文檔嚴重匱乏需要更多時間學習或不學習拖慢開發進度

開發和管理人員處理的問體和特性
-->多租戶  需要與其他客戶同時共享資源
-->第三方管理  管理系統不再組織控管的提供商
-->部署模型 (工友、私有、社區、混雲) 混合會移除或減少環境安全控制的授權和執行
-->服務模型(IaaS,PaaS,SaaS) 開發人員未必能對所使用特定架構或平台、應用站加以控制

常見雲應用部署陷阱
>>>本地(on premise)應用未必能夠遷移
-->>缺乏雲開發經驗造成應用向數據庫發起遠程調用請求發回數據所在企業、因原本是在局域網內不用考慮速度
-->>可多次都能快速交互響應而不是一次完成所有收集造成雲性能降低至無法運行的大量會畫創建佔用內存資源

>>>文件缺失
-->>因文黨編寫是個緩慢的系統過程兵不能增加應用的功能和性能，通常由不同人員完成造成複查度和延期可能
>>>並非所有應用都適用於雲環境
-->>需重新評估和修改才能在雲中有效運行、需使用未用過的加密技術、未必能立刻投入使用
>>>租戶隔離
-->>傳統都有組織擁有和控制、雲環境存在的風險、通過有效訪問控制、進程隔離、防止主機逃逸
-->>雲所有控制措施都依賴於遠程管理

>>>使用安全和經歷驗證API
-->>正式確定策略和流程、審核選擇和部署哪些可通過某種方式驗證API、來源和軟件可信度
```
```
雲軟體開發週期SDLC
-->定義：避免選擇任何具體工具或技術、需要真正考慮最能滿足業務需求的可能性
-->設計：用戶場景,介面需要使用或開發任何API、確定使用哪種語言和應用框架(REST,SOAP)
-->開發：已確認定義和設計參數，代碼片段測試確定是否按設計工作
-->測試：動態DAST 靜態SAST
-->安全運營：完成全面徹底測試和環境安全性後進入這階段
-->廢棄：完成使命或被新應用取代、必須安全的廢棄

-->大多軟件公司都會公開軟體的生命週期包括應用的使用多久、哪些安全補丁具體訊息、停止開發補丁信息
-->為保證組織所使用雲應用盡可能安全、避免漏洞和可能導致數據洩漏的其他風險
結構示例
>>>應用需求、應用設計、實現、驗證、生產發布
模型使用
>>>計畫和分析、定義、設計、開發、測試、維護

-->所有應用都會終止或進入迭代、廢棄是重要組成部分
```

```
ISO/IEC 27034-1應用開發安全標準
--業務環境、監管環境、技術環境、規格說明書、角色職責和資格、流程、應用安全控制ASC庫
>>>ANF&ONF是一對關係、應用都有ANF、ANF映射到對應一個ONF、ONF可以對應多個ANF
ONF  組織規範框架 Organization
ANF  應用規範框架 Application
ASMP 應用安全管理流程

身份和訪問管理 IAM
>>基於角色訪問控制方式、身份驗證後就獲得授權可對資源的後戶訪問權限
>>允許管理員通過修改角色屬性、會影響同屬的所有用戶成員
--身份管理 將用戶權限和定給身份關聯賦予訪問資源權限、配置：給每個主體唯一身份聲明和驗證驗身份聲明的密碼
-->密碼管理：密碼的生成、儲存和安全控制

--訪問管理： 獲得授權對資源訪問控制、是誰和每次被允許訪問資源
-->身份驗證  確定合法用戶和建立身份、透過身份聲明和身份驗證因素
-->授權     驗證後評估可訪問內容、根據身份聲明跟訪問控制列表比較
-->策略管理  身份驗證和授權執行體根據業務需求和高層管理決策建立
-->聯合驗證  組織間聯合體、有關用戶和資源訪問適當交互、不同組織間共享資源
-->身份儲存庫 管理用戶及關連屬性目錄服務

身份儲存庫
>>>X.500, LDAP, MS_AD, Novell eDirectory,源數據複製同步

--單點登入 SSO 簡化用戶操作的方法、一次登入後不須額外登入憑據
-->身份驗證服務器一次登入、每個資源都會查詢身份驗證服務器、確定是否已登入完成適當身份驗證
--聯合身份管理
->>Web of Trust 信任網：都必須審查和批准加入聯合驗證的每隔成員確定能達到特定的信任級別
>>昂貴、不靈活、擴展性不好

->>Third-party Identifier第三方標識符 外包給第三方代表所有組織行使職責，流行
>>標示浮角色通常與密鑰管理結合、給雲訪問安全代理CASB

-->聯合驗證標準 SAML2.0 基於XML是對多組織用戶進行身份驗證手段、用戶不必再兩個位址創建標示
->>WS-Federation, 使用術語 域realms說明組織間信任身份信息能力
->>OAuth,  常用於移動應用、向第三方應用提供HTTP服務的受限訪問
->>OpenID(OpenID Connect) OAuth2.0規範互相操作身份驗證、
->>>>允許開發人員跨網站和應用對用戶進行身份驗證、不需要管理用戶名和密碼

-->多因素身份驗證 提高電子匯款安全性、知道和擁有特徵對遠程身份驗證有用(令牌、生成數字)

-->輔助安全設備
>>>PCI首先要求部署WAF、保戶再線叫役應用外傳信用卡數據方法、因具感知應用行為能力、能檢測阻斷極小的異常活動
-->可針對網路曾拒絕服務DoS,DDoS訪護
>>>DAM數據庫活動監測、異常請求或行為法出警告來阻止惡意活動、可基於主機代理或網路


```
雲應用架構

```

--應用編程接口 RESTful
--REST 表述性狀態轉移:能擴展Web應用能力的軟體架構特性包括；
-->量級輕，使用簡單URL、不依賴XML，可擴展、可多種格式輸出(CVS,JSOM)、高效(消息比XML更小)

REST工作場景
-->帶寬受限、使用無狀態操作、需要緩存

--SOAP simple object access protocol 簡單對象訪問協議、可能在SMTP,FTP,HTTP上工作
>>>基於標準、依賴xml、高度不容錯、較慢、內置錯誤處理。
SOAP工作場景
>>>異步處理、有格式規範、有狀態操作

--租戶隔離(tenancy separation)
-->多租戶在同主機託管多個雲租戶共享資源，都在各自隔離環境維護
-->避免儲存錯誤配置可訪問其他租戶個人訊息，可能面零監管和法律的懲罰和財物損失

--密碼學
-->靜態數據加密 at rest 加密是防止未授權查看方法，避免可能法律原因沒收被窺視。
-->動態數據加密 in transit 傳輸數據加密也須使用密鑰(SSL證書)
-->使用數據加密 in use 同態加密(未廣泛用、緩慢)，數據交易的安全級數
-->傳輸層加密TLS 確保應用在通信隱私的協議、加密卸載crypto offloading
-->安全套接字層 SSL 2015已棄用
-->虛擬專用網路 IPSec VPN 端到端加密，
-->全實例加密 whole instance encryption/whole disk encryption,WDE 全盤加密，
>>>所有靜止狀態數據加密，>快照也能被獲取和訪問

-->卷volume加密 某個分區加密，只對具有價值加密

沙箱技術  一個受保護區域做尚未測試代碼和不可信代碼或更好確定應用是否按照預期工作
>>>不允許和應用或進程對內部進行訪問

應用虛擬化  在可信虛擬可信受保護環境運行完整測試新應用使否正常工作
--考慮因素：定義和聲明某類型軟體保證驗證流程、需按正常運行流程
>>>降低漏洞、缺陷下惡意代碼的風險

```
雲應用保證與驗證

```
--建模工具 trike, AS/ZNS4360,CVSS
-->威脅建模 STRIDE (MS) 通過更好的編碼解決或控制解決問題
>>>欺騙 spooling  仿冒行為ip或用戶欺騙
>>>竄改  tampering  涉及數據輸出入及儲存的數據
>>>抵賴  Repudiation  無法證明執行否認動作
>>>信息洩漏   數據洩漏或徹底暴露
>>>拒絕服務  導致應用失敗的任何攻擊類型、違反安全三原則CIA
>>>特權提升  elevation 提升權限在原授權之上


-->注入injection 字符注入操作應用或顯示未授權數據、例子包括SQL,LDAP,OS注入
-->失效身分驗證  破壞會話竊取令牌、密碼、密鑰、使惡意用戶劫持系統
-->跨站腳本(XSS)  僅次於注入攻擊、不適當驗證或轉碼的不可信數據發送給Web、就發生XSS在遊覽器執行代碼或劫持會話
-->不安全的直接對象訪問  未經訪問檢查、未採去防止攻擊操作數據的控制措施、對內部對象進行引用
-->安全錯誤配置  安全配置應定期查核和審計、自動化流程對系統和應用加固保持最新狀態

-->敏感數據洩漏 洩漏PII、醫療健保、卡號等、未使用加密、這播及標計化控制措施、透過應用系統洩漏
>>>>透過滲透和審計的例行檢查發現可能導致敏感數據洩漏錯誤配置或新代碼
-->功能及訪問控制缺失 應用功能通過用戶介面UI提供前應驗證級別訪問權限、若沒有可通過偽造請求使用未授權功能
-->跨站請求偽造CSRF  已登入用戶瀏覽器送偽造HTTP請求包含cookie和身份驗證資料的用戶合法請求
-->使用包含已知漏洞  使用越多開源和框架、產生提升權限的攻擊方法、控制攻擊者想要任何東西．
-->未驗證重定向和轉發 重定向沒考慮驗證、應用暴露不可信數據和其他應用或將指向釣魚站點

## CSA 2013發布 the notorious nine
>>>數據丟失  糟糕應用和數據庫設計、受損或硬件故障導致數據丟失
>>>數據洩漏  數據庫安全設計設置不當導致數據未經正確授權下暴露導致數據丟失
>>>帳戶接管或劫持 獲得控制權限、攻擊盜取會話、或將自己加入會話
>>>不安全的API   設計和實施不擋導致安全架構出現漏洞
>>>拒絕服務  使用應用服務不可用、而使服務中斷
>>>內部威脅  員工心生不滿造成嚴重破壞
>>>濫用雲服務 雲客戶進行非法或不道德的活動
>>>未盡到"應盡職責" 不遵循良好應盡職責實踐
>>>共享技術問題  有人進行錯誤配置或員工心懷不滿造成環境的危險
```

```
QoS 服務質量
--
軟件安全測試
-->漏洞掃描
-->EULA 最終用戶許可協議
-->白盒測試
-->黑盒測試
```
|SAST||||||
|:--|:--|:--|:--|:--|:--|
|DAST||||||
|||||||
```
>>>SAST XSS SLQ
>>>SAST DAST HTTP

-->框架核心組件
>>>識別、保護、檢測、響應、恢復
-->配置文件
-->框架實施層

已核准API
-->API API API
-->API  API
>>>
軟件供應鏈管理(API方面)
--> API API
開源軟件安全
-->敏捷
RASP運行應用自我保護 runtime application self protection
-->
代碼安全審查
>>>
>>>

```

```
OWASP 編碼缺陷

-->輸入驗證
-->源代碼設計
-->信息洩漏和不正確處理錯誤
-->直接對象引用
-->資源使用
-->API使用
-->違反最佳實踐
-->薄弱會話管理
-->使用HTTP get 查詢字串

```
